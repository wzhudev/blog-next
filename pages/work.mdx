---
type: page
title: Work
date: 2024-03-19
---

Aiming to build productivity applications (and libraries) that both users
and developers will love, I focused on collaborative algorithms, rendering
techniques, editors, and software architecture. I actively contributed to
the component library community during my internship.

Here's a summary of my work so far.

---

## Univer

[Univer](https://univer.ai) is a software development kit (SDK) for building office suites.
Documents, spreadsheets and slides. It's highly
extensible and can be embedded into other applications.

I joined Univer in its early stages as head of engineering to design its architecture, lead its
development, and guide the engineering team. I am thrilled to be a
part of this journey.

### Contributions

My techinal contributions on Univer primarily focused on the areas list below:

**Architecure design**

I designed the architecture of the Univer SDK. It uses a plugin-based architecture and dependency injection
to create a highly extensible architectural foundation.

In Univer, functionalities are registered into the application in the form of
plugins, which means that users can choose the plugins they register according
to their actual needs, and even develop their own plugins.

Moreover, it maximizes the isomorphism of various systems within Univer.
By loading different plugins and injecting different dependencies, Univer can
run on desktop and mobile browsers, as well as in web workers or Node.js as
a computation engine or collaborative engine. You can read more about this
architecturee in our [official guide](<https://univer.ai/guides/sheet/architecture/univer>).

**Collaborative editing system**

Collaborative editing is crucial to productivity applications. This involves
multiple people editing the same document simultaneously. I engineered Univer's
collaborative editing system from the ground up. The system leverages a state
machine model and operational transformation (OT). It delivers this capability
across various document types and supports offline editing. The team has
enhanced it with advanced transformation functions, a comprehensive file
history feature, and robust performance improvements.

You can read more about our system here: [The OT algorithm and Univer's Collaborative Editing Design](https://univer.ai/blog/post/ot).

**RPC & remote calculation**

For Univer instances deployed in different threads to communicate seamlessly,
I engineered and implemented the RPC architecture. Univer now excels at running
its frontend in the browser, while handling calculations in Web Worker,
or even in a Node.js process on the Univer server. This significantly boosts
performance and enhances user experience. You can read more about this on
our [official guide](https://univer.ai/guides/sheet/architecture/web-worker).

## Lark spreadsheets

At Lark spreadsheets I am responsible for maintaining several features and
started some new features.

Along with our tech leader and some co-workers, we designed a new architecture
for Lark spreadsheets and it is partially adopted in our codebase.

## Enterprise WeChat document

The Enterprise WeChat document is a collaborative editing application built
into Enterprise WeChat. During my tenure, the following work is noteworthy:

**Decoupling platform dependencies by introducing dependency injection**

In the code of the Enterprise WeChat document, the mobile and desktop code was
once very tightly coupled. In other words, the desktop would also load the
mobile code, even though it would not actually execute! I introduced a
dependency injection system, injecting respective implementations into the
desktop and mobile, thereby significantly reducing the package size.

**Splitting features and rmplementing lazy loading**

Before the document completed the first screen rendering, some features
unrelated to the first screen rendering initialization took up a lot of CPU
time. By splitting functions and implementing lazy loading for these functions,
I significantly postponed their initialization timings, thereby greatly reducing
the package size. Combined with some optimizations done by colleagues,
we successfully reduced the initialization time of an empty document to
less than 1 second.

**Text typesetting algorithm optimization**

The Enterprise WeChat documentation uses Canvas to render text. I optimized
the line-breaking algorithm so that it can correctly handle graphemes,
allowing for proper rendering of emojis. I also improved the algorithm for
processing lists by changing from full processing to incremental processing
that follows the typesetting progress, thereby reducing the loading time of
documents containing large lists by more than 10 seconds.

## redi

[Redi](https://redi.wendell.fun) is a powerful dependency injection utility inspired by VSCode. Building on
the simplicity of VSCode, Redi introduces advanced features such as injecting
factories, values, and even lazy values based on Promises.

Redi powers Univer and several applications in ByteDance.

## NG-ZORRO

[NG-ZORRO](https://ng.ant.design/) is an enterprise-class UI components based
on Ant Design and Angular. During my internship at Alibaba, I actively joined
the development of NG-ZORRO, was responsible for maining 20+ components and
developed quiet a few of them.
